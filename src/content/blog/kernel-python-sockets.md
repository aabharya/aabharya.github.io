---
author: Ali Abharya
pubDatetime: 2025-07-10T16:38:17.169Z
modDatetime: 2025-07-10T16:28:17.169Z
title: ุจุฑุฑุณ ุชุทุจู API ุณูฺฉุช ุฏุฑ ุณุณุชูโุนุงูู ู ูพุงุชูู
title_seo: Socket API review in Kernel and Python
slug: socket-api-review
featured: true
draft: false
tags:
  - socket
  - tcp
  - kernel
  - python
  - http

description: ุณูฺฉุชโูุง ุฏุฑ ุณุทุญ ุณุณุชูโุนุงูู ู ูพุงุชูู
---

# ุณูฺฉุชโูุง ุฏุฑ ุณุทุญ ุณุณุชูโุนุงูู ู ูพุงุชูู

ุงุฒ ฺูุฏ ุฑูุฒ ูพุด ฺฉู ุฏูุฑ ุฏูู ูุทุงูุนู ฺฉุชุงุจ **HTTP: The Definitive Guide** ุฑู ุดุฑูุน ฺฉุฑุฏู ุงุฏ ุฌููู ุญุณูโูุงุตุฑ ุงูุชุงุฏู ฺฉู ูฺฏู:

> ูู ุจุง ูฺ ุงุจุฒุงุฑ ฺฉุงุฑ ููโฺฉูู ูฺฏุฑ ุงูฺฉู ฑฐฐ ุฏุฑุตุฏ ุฌุฒุงุช ุฏุงุฎูุด ุฑู ุนููุง ุฏุฑฺฉ ฺฉุฑุฏู ุจุงุดู.

ููู ุดุฏ ฺฉู ุจู ุจุฎุด ุณูฺฉุชโูุง ฺฉู ุฑุณุฏู ุชุตูู ฺฏุฑูุชู ฺฉุจุงุฑ ุฏุณุชูุฑ ุงุฌุฑุง ุณุฑูุฑ HTTP ู ูููุทูุฑ ููุฏู ฺฉุฑุฏู ฺฉ ุฏุฑุฎูุงุณุช HTTP ุฑู ุชู ูพุงุชูู ุฏุจุงฺฏ ฺฉูู. ูุฏูู ูู ุงู ุจูุฏ internal ฺฉุชุงุจุฎููู ุงุณุชุงูุฏุงุฑุฏ ูพุงุชูู ู ูููุทูุฑ ุงูุชุฑูุณ WSGI ุฑู ุจุดุชุฑ ุฏุฑฺฉ ฺฉูู ุจู ุนูุงูู ุจุฑุงู ุฌุงูุจ ุจูุฏ ฺฉู ุจุฏููู ุงุฒ ุณูุช ุณุณุชู ุนุงูู ูู ุงู ูุณุท ฺู ุงุชูุงูุงุช ูููุชูุ

![http_dfg](@assets/images/http_dfg.jpeg)

ุฎู ุฎูุงุตู ุจุฎูุงู ุจฺฏู ุจุงุฒฺฏุฑ ุงุตู ุงู ูุณุท ู ููููู ูุณุช ุจู ูุงู ุณูฺฉุช ฺฉู ูู ุณุณุชูโุนุงูู ู ูู ฺฉุชุงุจุฎููู ุงุณุชุงูุฏุงุฑุฏ ูพุงุชูู ู API ุจุฑุง ุงูู ุฏุงุฑู ู ุฏุฑ ุญููุช ุงูู ฺุฑุฎู request - response ุจู ฺฉูุงูุช ู ุณุฑูุฑ ุงุฒ ุทุฑู ููู ุณูฺฉุช ููุฏู ูุดู.

ุงู ููุดุชู ุฏู ุจุฎุด ุฏุงุฑู:โ

- ุงูู ุงูฺฉู ุณูฺฉุช ฺ ูุณุช ู ุฏุฑ ุณุทุญ ุณุณุชูโุนุงูู ฺู ุนููุงุช ูุดู ุจุงูุงุด ุงูุฌุงู ุฏุงุฏุ

- ุฏูู ุงูฺฉู ููุช ุชู ูพุงุชูู ู ุณุฑูุฑ HTTP ุงุฌุฑุง ูโฺฉูู ู ฺฉ ุฏุฑุฎูุงุณุช ุงุฒ ุณูุช ฺฉูุงูุช ูุงุฏ ุชุง ูพุงุณุฎ ุฑู ุฏุฑุงูุช ฺฉูู ฺู ูุฑุงุฎูุงูโูุง ุฏุฑ ูพุงุชูู ุงูุฌุงู ูุดู ู ูพุดุชโุตุญูู ุงููโูุง ฺู ูุฑุงุฎูุงูโูุง ุฏุฑ ุณุทุญ ุณุณุชูโุนุงูู ุงูุฌุงู ูุดูุ

---

## ุณูฺฉุช ุฏุฑ ุณุทุญ ุณุณุชูโุนุงูู

### 1๏ธโฃ ุณูฺฉุช ฺ ูุณุชุ!

ุณูฺฉุช ุฑู ูุดู ู ุณุงุฎุชุงุฑ ุฏุงุฏู ุฏุฑ ูุธุฑ ฺฏุฑูุช ฺฉู processูุง ุงุฒ ุทุฑู ุงูู ูโุชููู ุจุง ูู ุตุญุจุช ฺฉูู. ุงู processูุง ูโุชููู ุฑู ฺฉ ูุงุดู ุจุงุดู ฺฉู ุนููุง ููุน ุณูฺฉุชโุดูู ูุดู Unix Socket ุง ุงูฺฉู ูุชููู ุฑู ุฏู ูุงุดู ุจุงุดู ู ุงุฒ ุทุฑู ุดุจฺฉู ุจุง ูู ุตุญุจุช ฺฉูู (ฺฉูุงูุช ู ุณุฑูุฑ) ฺฉู ููุน ุณูฺฉุชโูุงุด ูุดู TCP ุง UDP ฺฉู ุงูุฌุง ุฑู ุณูฺฉุชโูุง TCP ุชูุฑฺฉุฒ ูโฺฉูู.

ุณูฺฉุชโูุง ุณุงุฎุชุงุฑ ุฏุงุฏู ูุงุฒู ุจุฑุง ุงูุฏูพููุชโูุง TCPุฑู ุงุฌุงุฏ ูโฺฉูู ู ุงูฺฉุงู ูุฏู ฺฉู ุฌุฑุงู ุฏุงุฏูโูุง ุฎูุงูุฏู ู ููุดุชู ุจุดู. API ูุฑุจูุท ุจู ุงูู ุชูุงู ุฌุฒุฆุงุช ูุฑุจูุท ุจู ูุฑุขูุฏ `handshaking` ู ุณุงุฑ ูุงูโูุง ุฒุฑุณุงุฎุช ุดุจฺฉู ู ุฌุฑุงู ุฏุงุฏูโูุง ูุฑุจูุท ุจู ุจุณุชูโูุง IP ุฑู ูพููุงู ูโฺฉูู. ุจู ุนุจุงุฑุช ุฏฺฏู ุชู ูุฏู OSI ุดุจฺฉู ุจุฑูุงููโููุณโูุง ุฏุฑ ูุงู ท (ุงูพูฺฉุดู) ุจุง ุณูฺฉุชโูุง ุณุฑูฺฉุงุฑ ุฏุงุฑู ู ุงุฒ ุทุฑู ฺฉุชุงุจุฎูููโูุง ุณุทุญ ุจุงูุง ูุฑุงุฎูุงูโูุง ุณุณุชู ูุฑุจูุท ุจู ุณูฺฉุช ุฑู ุงูุฌุงู ูุฏู ุชุง ูุชูุงุธุฑ ุจุง ุงูู ูุฑุงุฎูุงูโูุง ุฏุฑ ูุงู 4 (ุดุจฺฉู) ุฏุงุฏูโูุง ุจู ุฏู ุชุง process ุฏุฑ ุดุจฺฉู ููุชูู ุจุดู.

ุฏุฑ ุณุทุญ ุณุณุชูโุนุงููุ ุณูฺฉุช ุฑู ูุดู ุดุจู ฺฉ ูุงู ุฏุฑ ูุธุฑ ฺฏุฑูุช ฺฉู ูุดู ุฑู ุงูู ุนููุงุช ุฎูุงูุฏู ู ููุดุชู ุงูุฌุงู ุฏุงุฏ. ููุช ฺฉ ุณุฑูุฑ ุฑุงูโุงูุฏุงุฒ ูุดู ุณุณุชูโุนุงูู ุงุจุชุฏุง ฺฉ ุณูฺฉุช ุดูููุฏู `(Listening Socket)` ุงุฌุงุฏ ูโฺฉูู ฺฉู ุฑู ฺฉ ุขุฏุฑุณ IP ู ูพูุฑุช ุฎุงุต (ูุซูุงู 0.0.0.0:8000) ุขูุงุฏู ุฏุฑุงูุช ุฏุฑุฎูุงุณุชโูุงุณุช.

ุงู ุณูฺฉุช ุตุฑูุงู ูุณุฆูู ุฏุฑุงูุช ุฏุฑุฎูุงุณุชโูุง ุงุชุตุงู `(SYN)` ูุณุช ู ุฏุงุฏูู ูุงูุน ุฑู ููุชูู ููโฺฉูู. ุจู ูุญุถ ุงูฺฉู ฺฉูุงูุช ุฏุฑุฎูุงุณุช ุงุชุตุงู ูุฏูุ ุณุณุชูโุนุงูู ฺฉ ุณูฺฉุช ุฌุฏุฏ ุจู ูุงู ุณูฺฉุช ุงุชุตุงู `(Connection Socket)` ูโุณุงุฒู ฺฉู ูุฎุชุต ูููู ฺฉูุงูุช ุงุณุช. ุจูุงุจุฑุงู ูุฑ ฺฉูุงูุช ุณูฺฉุช ูุณุชูู ุฎูุฏุด ุง `File Descriptor` ุฎูุฏุด ุฑู ุฏุงุฑู ู ุฏุงุฏูโูุงุด ุจุง ุณุงุฑ ฺฉูุงูุชโูุง ุชุฏุงุฎู ูพุฏุง ููโฺฉูู.

![sct_act](@assets/images/socket_actions.png)

---

### 2๏ธโฃ ุนููุงุช ูุงุจู ุงูุฌุงู ุจุง ุณูฺฉุช ุฏุฑ ุณุทุญ ุณุณุชูโุนุงูู

ุฏุฑ ฺุฑุฎู ุฏุฑุฎูุงุณุช ูพุงุณุฎ ุจู ฺฉูุงูุช ู ุณุฑูุฑ bind ู listen ู accept ู read ู write ูพูุฌ ุนููุงุช ุงุตู ุฏุฑ ุงู ูุฑุขูุฏ ูุณุชูุฏ. ุฏุฑ ุฌุฏูู ุฒุฑ ููู ุนููุงุช ูุงุจู ุงูุฌุงู ุชูุณุท API ุณูฺฉุช ุฏุฑ ุณุทุญ ุณุณุชูโุนุงูู ุฎูุงุตู ุดุฏูโุงูุฏ:

| API ุณูฺฉุช ุฏุฑ ุณุทุญ ุณุณุชูโุนุงูู    | ุชูุถุญุงุช                                            |
| ----------------------------- | -------------------------------------------------- |
| (< parameters >)socket        | ุงุฌุงุฏ ฺฉ ุณูฺฉุช ุฌุฏุฏ ุจุฏูู ูุงู ู ุจุฏูู ุงุชุตุงู           |
| (s, local IP : port )bind     | ุงุฎุชุตุงุต ฺฉ ุดูุงุฑู ูพูุฑุช ู ุงูุชุฑูุณ ุจู ุณูฺฉุช            |
| (s, remote IP : port )connect | ุงุฌุงุฏ ฺฉ ุงุชุตุงู TCP ุจู ุณูฺฉุช ู ฺฉ host ู ูพูุฑุช remote |
| (..., s)listen                | ุชุบุฑ ูุถุนุช ุณูฺฉุช ุจุฑุง ุฏุฑุงูุช ุฏุฑุฎูุงุณุช               |
| (s)accept                     | ููุชุธุฑ ูุงูุฏู ุจุฑุง ุงุฌุงุฏ ฺฉ ุงุชุตุงู ุจู ูพูุฑุช            |
| (s, buffer, n)read            | ุฎูุงูุฏู n ุจุงุช ุงุฒ ุณูฺฉุช ุจู ุฏุงุฎู ุจุงูุฑ                 |
| (s, buffer, n)write           | ููุดุชู n ุจุงุช ุงุฒ ุจุงูุฑ ุจู ุฏุงุฎู ุณูฺฉุช                  |
| (s)close                      | ุจุณุชู ฺฉุงูู ุงุชุตุงู TCP                                |
| (s, side)shutdown             | ุจุณุชู ููุท ูุฑูุฏ ุง ุฎุฑูุฌ ุงุชุตุงู TCP                  |
| (..., s)getsockopt            | ุฎูุงูุฏู ููุฏุงุฑ ฺฉ ูพฺฉุฑุจูุฏ ุฏุงุฎู ุณูฺฉุช                |
| (..., s)setsockopt            | ุชุบุฑ ููุฏุงุฑ ฺฉ ูพฺฉุฑุจูุฏ ุฏุงุฎู ุณูฺฉุช                 |

---

## ุณูฺฉุช ุฏุฑ ุณุทุญ ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ูพุงุชูู

### 1๏ธโฃ ุงูุชุฑูุณ WSGI

WSGI ุง **Web Server Gateway Interface** ฺฉ ุงุณุชุงูุฏุงุฑุฏ ุฑุณู ุฏุฑ ูพุงุชูู ุจุฑุง ุจุฑูุฑุงุฑ ุงุฑุชุจุงุท ุจู ูุจโุณุฑูุฑูุง ู ูุฑูโูุฑฺฉโูุง ุง ูุจโุงูพูฺฉุดูโูุง ูพุงุชูู ูุณุช. ูพุด ุงุฒ ูุนุฑู WSGIุ ูุฑ ูุจโุณุฑูุฑ ู ูุฑูโูุฑฺฉ ุฑูุด ุฎุงุต ุฎูุฏุด ุฑู ุจุฑุง ุชุจุงุฏู ุฏุงุฏู ูพุงุฏูโุณุงุฒ ูโฺฉุฑุฏ ู ุงู ุจุงุนุซ ูุงุณุงุฒฺฏุงุฑ ู ูพฺุฏฺฏ ุชูุณุนู ูโุดุฏ. WSGI ุงู ูุดฺฉู ุฑู ุจุง ุชุนุฑู ฺฉ ูุฑุงุฑุฏุงุฏ ุณุงุฏู ุญู ฺฉุฑุฏ:

ูุจโุณุฑูุฑ ุฏุฑุฎูุงุณุช HTTP ุฑู ุจู ุดฺฉู ุฏุงุฏูโูุง ุณุงุฎุชโุงูุชู ุจู ุงูพูฺฉุดู ููุชูู ูโฺฉูู ู ุงูพูฺฉุดู ูู ูพุงุณุฎ HTTP ุฑู ุจู ููุงู ุดฺฉู ุงุณุชุงูุฏุงุฑุฏ ุจู ุณุฑูุฑ ุจุฑูโฺฏุฑุฏููู.

ุงู ูุฏูุ ุงูพูฺฉุดู ู ุณุฑูุฑ ุฑู ุงุฒ ูู ุชูฺฉฺฉ ูฺฉูู ู ุจู ุชูุณุนูโุฏููุฏู ุงุฌุงุฒู ูุฏู ุจุฏูู ูุงุจุณุชฺฏ ุจู ููุน ูุจโุณุฑูุฑุ ุงูพูฺฉุดู ุฎูุฏุด ุฑู ูพุงุฏูโุณุงุฒ ู ุงุฌุฑุง ฺฉูู. ูุซูุง ููุช ุจุง ุฌูฺฏู ุณุฑูุฑ ููฺฉุงู ุฑู ุฑุงูโุงูุฏุงุฒ ูโฺฉูู ฺฉุฏ ุฒุฑ ุงุฌุฑุง ูุดู ฺฉู ู instance ุงุฒ ฺฉูุงุณ `WSGIServer` ุฑู ุงุฌุงุฏ ูโฺฉูู ู ุจูุด ูโฺฏู ฺฉู ุชูุงู ุฏุฑุฎูุงุณุชโูุง ฺฉูุงูุชโูุง ุฑู ุจุง `WSGIRequestHandler` ูพุงุณุฎ ุจุฏู:

```python
# file: django/core/servers/basehttp.py
def run(addr, port, wsgi_handler, ipv6=False, threading=False, on_bind=None,server_cls=WSGIServer):
    server_address = (addr, port)
    if threading:
        httpd_cls = type("WSGIServer", (socketserver.ThreadingMixIn, server_cls), {})
    else:
        httpd_cls = server_cls
    httpd = httpd_cls(server_address, WSGIRequestHandler, ipv6=ipv6)
    if on_bind is not None:
        on_bind(getattr(httpd, "server_port", port))
    if threading:
        httpd.daemon_threads = True
    httpd.set_app(wsgi_handler)
    httpd.serve_forever()

```

ูุชุฏูุง ฺฉู ุงูุฌุง ูุงุฒูู ุจุดุชุฑ ุฏุฑุจุงุฑูโุงุด ุนูู ุจุดู ฺฉ ููู `serve_forever` ูุฑุจูุท ุจู `WSGIServer` ูุณุช ู ฺฉ ุฏฺฏู ูู ุฏุงุฎู ฺฉูุงุณ `WSGIRequestHandler` ูุณุช ุจู ูุงู `handle_one_request` ูู ูุจู ุงูโูุง ูุงุฒูู ุฏุฑุจุงุฑู ุณูฺฉุชโูุง ุฏุฑ ฺฉุชุงุจุฎููู ุงุณุชุงูุฏุงุฑุฏ ูพุงุชูู ฺฉู ุจุดุชุฑ ุจุฏููู .

### 2๏ธโฃ ุณูฺฉุชโูุง ุฏุฑ ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ ูพุงุชูู

ฺฉุชุงุจุฎููู ุงุณุชุงูุฏุงุฑุฏ `socket` ูพุงุชูู ู wrapper ุฑู ูููู API ุณุทุญ ุณุณุชูโุนุงูู ุจุฑุง ุณูฺฉุชโูุงุณุช ฺฉู ุนููุง ุงุณู ูุชุฏูุง ูพุงุชูู ุจุง ุงุณู ุนููุงุช ุณุณุชูโุนุงูู ูุดุงุจู ู ฺฉ ูุณุช. ูุซูุง ููุช ุชู ูพุงุชูู `()socket.socket` ุฑู ูุฑุงุฎูุงู ฺฉูู ุฏุฑ ุงุตู ุจู ุณุณุชูโุนุงูู ุฏุฑุฎูุงุณุช ุฏุงุฏู ฺฉู ฺฉ ุณูฺฉุช ุฌุฏุฏ ุณุงุฎุชู ุจุดู ฺฉู ุงู ฺฉุงุฑ ุงุฒ ุทุฑู ูุฑุงุฎูุงู ุณุณุชู `()socket` ุงูุฌุงู ูุดู.

| API ุณูฺฉุช ุฏุฑ ุณุทุญ ูพุงุชูู  | ุชูุถุญุงุช                                 |
| ----------------------- | --------------------------------------- |
| ()bind                  | ุงุชุตุงู ุณูฺฉุช ุจู ฺฉ ุขุฏุฑุณ ู ูพูุฑุช            |
| (address)connect        | ุงุฌุงุฏ ฺฉ ุจุฑูุฑุงุฑ ุงุชุตุงู TCP ุจุง ุณุฑูุฑ ููุตุฏ |
| (backlog)listen         | ุชุบุฑ ูุถุนุช ุณูฺฉุช ุจุฑุง ุฏุฑุงูุช ุฏุฑุฎูุงุณุช    |
| ()accept                | ุงุฌุงุฏ ฺฉ ุณูฺฉุช ุฌุฏุฏ ุจุฑุง ูุฑ ฺฉูุงูุช       |
| (buffersize, flags)recv | ุฎูุงูุฏู ุฏุงุฏู ุงุฒ ุณูฺฉุช                     |
| (data, flags)send       | ุงุฑุณุงู ุฏุงุฏู ุจู ุณูฺฉุช                      |
| ()close                 | ุจุณุชู ฺฉุงูู ุงุชุตุงู TCP                     |
| (flag)shutdown          | ุจุณุชู ููุท ูุฑูุฏ ุง ุฎุฑูุฌ ุงุชุตุงู TCP       |

---

### 3๏ธโฃ ููููู ุณุฑูุฑ echo ุจุง ฺฉุชุงุจุฎุงูู ุงุณุชุงูุฏุงุฑุฏ

ฺฉุชุงุจุฎููู ุงุณุชุงูุฏุงุฑุฏ ูพุงุชูู ูููู API ุณุณุชูโุนุงูู ุฑู ุฏุฑ ุงุฎุชุงุฑ ูฺฏุฐุงุฑู ุนู ูููู ุนููฺฉุฑุฏูุง ุจุง ูููู ุงุณุงู. ุจู ุตูุฑุช ฺฉู ูุดู ฺฏูุช ูุฑุงูุฏ ูุฑุจูุท ุจู ุณูฺฉุชโูุง ููุดู ููู ุงูฺฏู ุฑู ุฏุงุฑู ฺฉู ุงู ุงูฺฏู ุฑู ุฏุฑ ูุซุงู ุฒุฑ ุชูุถุญ ูโุฏู:

`socket โ bind โ listen โ accept โ send/recv โ close`

ุงูุจุชู ูุจูุด ุจฺฏู ุงูฺฉู ุงู ูุซุงู ุจุฑุง ุงุฌุฑุง ุงุฒ `asyncio` ุงุณุชูุงุฏู ฺฉุฑุฏู ุง ุจุฑุง ุฑุงูโุงูุฏุงุฒ ุณุฑูุฑ `WSGI` ุงุฒ `ThreadingMixIn` ุงุณุชูุงุฏู ูุดู ููุถูุน ูุณุช ฺฉู ุจุนุฏุง ุฏุฑุจุงุฑูโุงุด ุชูุถุญ ูุฏู ูู ูุณุชููุง ุจู ููุถูุน ุณูฺฉุช ูุฑุจูุท ูุณุช.

ฺฉุฏ ุฒุฑ ฺฉ ุณุฑูุฑ echo ุณุงุฏู ูุณุช ู ุณุฑูุฑ ูุฑ ฺุฒ ฺฉู ฺฉูุงูุช ุจุฑุงุด ูโูุฑุณุชู ุฑู ุจูุด ุจุฑโูโฺฏุฑุฏููู. ุจุนุฏ ุงุฒ ุงุฌุฑุงุด ูุดู ุจุง telnet ุฒุฏู ุจู ููฺฉุงูโูุงุณุช ู ูพูุฑุช 9999 ุงูู ุฑู ุชุณุช ฺฉุฑุฏ.

```python

import asyncio
import socket
from asyncio import AbstractEventLoop


async def echo(connection: socket, loop: AbstractEventLoop) -> None:
    while data := await loop.sock_recv(connection, 1024):
        await loop.sock_sendall(connection, data)


async def listen_for_connection(server_socket: socket, loop: AbstractEventLoop):
    while True:
        connection, client_address = await loop.sock_accept(server_socket)
        connection.setblocking(False)
        print('Connection from', client_address)
        asyncio.create_task(echo(connection, loop))


async def main() -> None:
    server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    server_socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
    server_address = ('127.0.0.1', 9999)
    server_socket.bind(server_address)
    server_socket.setblocking(False)
    server_socket.listen()
    await listen_for_connection(server_socket, asyncio.get_event_loop())


if __name__ == '__main__':
    asyncio.run(main())
```

ุจุง ุงุฌุฑุง `socket.socket(socket.AF_INET, socket.SOCK_STREAM)` ู ุณูฺฉุช TCP ุงุฌุงุฏ ูุดู ู ุนููุง `()socket` ุฏุฑ ุณุทุญ ุณุณุชูโุนุงูู ูุฑุงุฎูุงู ูุดู. ููุงุฏุฑ ฺฉู ุจู ุนููุงู ุขุฑฺฏููุงู ูพุงุณ ุฏุงุฏู ูุดู ูพุงุฑุงูุชุฑูุง ุณูฺฉุช ูุณุชู: `AF_INET` ุนู ุขุฏุฑุณโูุง ุงุฒ ููุน `IPv4` ุจุงุฏ ุจุงุดู ู `SOCK_STREAM` ูู ุนู ููุน ุณูฺฉุช ุงุฒ ูพุฑูุชฺฉู TCP ูุณุช. ุจุนุฏ ุงุฒ ุงูู ุณูฺฉุช ุจู ุขุฏุฑุณ ู ูพูุฑุช `bind` ูุดู ู ุจุนุฏุด ุจู ุญุงูุช `listen` ูุบุฑ ูุถุนุช ูุฏู ฺฉู ูุฑุงุฎูุงูโูุง ุณุณุชูโุนุงูู ู ูพุงุชูู ุงูู ุฏููุง ูู ูุงู ูุณุชู.

ุจุนุฏ ุงุฒ ุงู ูุฑุญูู ุจุฑุง ุงูฺฉู ุฏุฑุฎูุงุณุชโูุง ููุฒูุงู ฺฉูุงูุชโูุง ููุฏฺฏู ุฑู ุจูุงฺฉ ูฺฉูู ููุฏู ฺฉุฑุฏู ุงููโูุง ุงุฒ ุทุฑู `event loop` ฺฉูุชุฑู ูุดู. ูุชุฏ `listen_for_connection` ููุชุธุฑ ู ุฏุฑุฎูุงุณุช ุงุชุตุงู ุฌุฏุฏ ูโูููู ู ุงุฒ ุทุฑู `loop.sock_accept` ูุฑุงุฎูุงู ุณุณุชูโุนุงูู `accept` ุฑู ุงูุฌุงู ูุฏู. ุงู ฺฉุงุฑ ุจู ุตูุฑุช `non-blocking` ุงูุฌุงู ูุดู ู ุณุฑูุฑ ูโุชููู ุจูุงูุงุตูู ุฏุฑุฎูุงุณุช ุฌุฏุฏ ฺฉ ฺฉูุงูุช ุฏฺฏู ุฑู ูู ููุฏู ฺฉูู.

ุฏุงุฎู ูุชุฏ `echo` ู ุญููู ุจโููุงุช ูุณุช ฺฉู ุฏุงุฏูโูุง ุฑู ุงุฒ ฺฉูุงูุช ุฏุฑุงูุช ูโฺฉูู ู ููููโุฏุงุฏูโูุง ุฑู ุจู ฺฉูุงูุช ุจุฑโูฺฏุฑุฏููู. ูุชุฏูุง `loop.sock_recv` ู `loop.sock_sendall` ุนููุง ูุฑุงุฎูุงูโูุง ูุฑุจูุท ุจู `recv` ู `send` ุณุณุชูโุนุงูู ุฑู ุงูุฌุงู ูุฏู.

```shell
    telnet 127.0.0.1 9999
    Trying 127.0.0.1...
    Connected to 127.0.0.1.
    Escape character is '^]'.
    hello world!
    hello world!
```

### 4๏ธโฃ ูุฑุงุฎูุงูโูุง ุณูุช ูพุงุชูู ุฏุฑ ุฒูุงู ูพุงุณุฎ ุจู ุฏุฑุฎูุงุณุช HTTP

ุญุงูุง ูโุชููู ุจู ุณุฑูุฑ `WSGI` ุจุฑฺฏุฑุฏู. ุฏุฑ ุฒูุงู ุฑุงูโุงูุฏุงุฒ ุณุฑูุฑ `WSGI` ุฏุฑ ุตูุฑุช ฺฉู ุขุฑฺฏููุงู `threading` ูพุงุณ ุฏุงุฏู ุดุฏู ุจุงุดู ุจู ุณุฑูุฑ `WSGI` ุฑูุชุงุฑ `socketserver.ThreadingMixIn` ูู ุงุถุงูู ูุดู. ุฏุฑ ุญููุช ูุดู ุงูุทูุฑ ูุฑุถ ฺฉุฑุฏ ฺฉู ุจุฑุง ููุฏู ฺฉุฑุฏู ูุฑ ุฏุฑุฎูุงุณุช ู `Thread` ุฌุฏุฏ ุฏุฑุณุช ูุดู. ุงุฏู ูุดุงุจู ฺฉู ุจุงูุงุชุฑ ูุซุงูุด ุฑู ุจุง `asyncio` ุฏุฏู ุงูุจุชู ุงููุฌุง `task` ุฏุฑุณุช ูุดุฏ. ุจุฑุง ุงูฺฉู ุณุงุฏูโุชุฑ ุจุดู ูโุชููู ูุฑุถ ฺฉูู ูุชุฏ `()serve_forever` ุฏุฑ ุณุฑูุฑ `WSGI` ูููู ฺฉุงุฑ ุฑู ูฺฉูู ฺฉู `listen_for_connection` ุฏุฑ ูุซุงู ุณุฑูุฑ echo ุงูุฌุงู ูุฏู ุนู ุจุง ูููู ุงุฏู ฺฉู ุฏุฑุฎูุงุณุชโูุง ููุฏฺฏู ุฑู ุจูุงฺฉ ูฺฉูู ุจู ุฏุฑุฎูุงุณุชโูุง ููุฒูุงู ูพุงุณุฎ ูุฏู.

ุงุฒ life cycle ฺฉ ุฏุฑุฎูุงุณุช HTTP ุชุง ุงูุฌุง ูพุด ุงููุฏู ฺฉู ุณุฑูุฑ ฺฉ ุณูฺฉุช ุดูููุฏู ุงุฌุงุฏ ฺฉุฑุฏูุโ ุจู ฺฉ ุขุฏุฑุณ `bind` ุดุฏู ู ุญุงูุง ุขูุงุฏู ุดูุฏู ุฏุฑุฎูุงุณุชโูุงุณุช. ู ุณุฑูุฑ ูพุงุชูู ุจุนุฏ ุงุฒ ุงูฺฉู ุฏุฑุฎูุงุณุช ุจุฑุงุด ูุงุฏ ู `accept` ูฺฉูู ุจุง ู ุงูุชุฑูุณ ุจู ูุงู `BaseRequestHandler` ุฏุฑุฎูุงุณุช ุฑู ููุฏู ูฺฉูู. ูุทุงุจู ุงูู ูุฑุงูุฏ ุงุตู ุณูฺฉุชโูุง ฺฉู ุจุงูุงุชุฑ ฺฏูุชู ุงู ุงูุชุฑูุณ ฺฉุงุฑุด ุงูู ฺฉู ุฏุงุฏูโูุง ุฑู ุจุฎููู ุง ุจููุณู `send/recv` ู ุฏุฑ ููุงุช ุณูฺฉุช ุฑู ุจุจูุฏู `close`. ุงู ุงูุชุฑูุณ ุจู ุดฺฉู ุฒุฑ ูุณุช:

```python
# file: python3.12:socketserver.py

class BaseRequestHandler:

    def __init__(self, request, client_address, server):
        self.request = request
        self.client_address = client_address
        self.server = server
        self.setup()
        try:
            self.handle()
        finally:
            self.finish()

    def setup(self):
        pass

    def handle(self):
        pass

    def finish(self):
        pass

```

ููููุทูุฑ ฺฉู ุจุงูุงุชุฑ ุชูุถุญ ุฏุงุฏู ุชู ุงุณุชุงูุฏุงุฑุฏ `WSGI` ุฏุฑุฎูุงุณุชโูุง ุจุง ฺฉูุงุณ `WSGIRequestHandler` ุงุฒ ุงู ุงูุชุฑูุณ ูพุงุฏูโุณุงุฒ ูุดู. ุงูู ุจุฎุด ููู ฺฉู ูุงุฒ ุจู ุชูุถุญ ุฏุงุฑู ูุชุฏ `handle` ูุณุช ฺฉู ูุฑุงุฎูุงูโูุง `send/recv` ุงููุฌุง ุงูุฌุงู ูุดู. ฺฉุฏ ุฒุฑ ูพุงุฏูโุณุงุฒ ุฌูฺฏู ุจุฑุง ููุฏู ฺฉุฑุฏู ุฑฺฉูุฆุณุชโูุงุณุช:

```python
# file: django/core/servers/basehttp.py
# class WSGIRequestHandler

    def handle(self):
        self.close_connection = True
        self.handle_one_request()
        while not self.close_connection:
            self.handle_one_request()
        try:
            self.connection.shutdown(socket.SHUT_WR)
        except (AttributeError, OSError):
            pass

    def handle_one_request(self):
        self.raw_requestline = self.rfile.readline(65537)
        if len(self.raw_requestline) > 65536:
            self.requestline = ""
            self.request_version = ""
            self.command = ""
            self.send_error(414)
            return

        if not self.parse_request():  # An error code has been sent, just exit
            return

        handler = ServerHandler(
            self.rfile, self.wfile, self.get_stderr(), self.get_environ()
        )
        handler.request_handler = self  # backpointer for logging & connection closing
        handler.run(self.server.get_app())

```

ุจุฑุง ุชูุถุญ ุงุชูุงูุงุช ฺฉู ุงูุฌุง ูููุชู ูุฑุถ ฺฉูู ฺฉู ุณุฑูุฑ ุฑู ููฺฉุงูโูุงุณุช ู ูพูุฑุช 8000 ุฑุงูโุงูุฏุงุฒ ุดุฏู ู ูุง ู ุฏุฑุฎูุงุณุช ุจุฑุง ุงูุฏูพููุช `/products` ูโุฒูู:

```shell
curl -X GET http://localhost:8000/products/
```

ููุช ุงู ุฏุฑุฎูุงุณุช ุจู ุณุฑูุฑ `WSGI` ูุฑุณู ู ฺฉุงุฑูุง ุฑุงูโุงูุฏุงุฒ ุณูฺฉุช ฺฉูุงูุช ู `accept` ุดุฏูุด ุงูุฌุงู ูุดู ุฏู ุชุง ุขุจุฌุช ุฏุฑุณุช ูุดู ุจู ูุงูโูุง `rfile` ู `wfile` ฺฉู ุนููุง ุดุจู ุจุงูุฑ ุนูู ูโฺฉูู ฺฉู ูุฑุงุฎูุงูโูุง ูุฑุจูุท ุจู `send/recv` ุฑู ุจุฑุง ุณูฺฉุชโูุง ุงูุฌุงู ูุฏู.

ุจู ุนุจุงุฑุช ุฏฺฏู ฺฉูุงูุช ุฏุฑุฎูุงุณุชโูุงุด ุฑู ุฑู `rfile` ูุฐุงุฑูุ ุขุจุฌฺฉุช `WSGIRequestHandler` ุงูู ุฑู ูุฎูููุ ูพุฑุฏุงุฒุด ูโฺฉูู ุจู ุงูพูฺฉุดู ุชุญูู ูุฏูุ ูพุงุณุฎ ุฑู ุงุฒ ุงูพูฺฉุดู ูโฺฏุฑู ู ูพุงุณุฎ ุฑู ุฑู `wfile` ูโููุณู ู ุงุฒููุฌุง ุจุฑุง ฺฉูุงูุช ุงุฑุณุงู ูุดู. ูุซูุง ููุช ฺฉู ุฏุฑุฎูุงุณุช ุจุงูุง ุจุฑุง ุณุฑูุฑ ูุงุฏ ููุฏุงุฑ ุฒุฑ ุฏุฑ `rfile` ูุฑุงุฑ ุฏุงุฏู ูุดู:

```shell
b'GET /products/ HTTP/1.1\r\n'
```

ูุธูู ุขุจุฌุช `WSGIRequestHandler` ุงูู ฺฉู ุงู ููุฏุงุฑ ุฑู ุจุฎููู ุจุนุฏุด `parse` ฺฉูู ู ุจู ุงูพูฺฉุดู ุชุญูู ุจุฏู. ุงุฒ ุงูุฌุง ุจู ุจุนุฏ ูุณุฑ ุฏุฑุฎูุงุณุช ุชู ุงูพูฺฉุดู ูพุงุชูู ฺฉู ูุง ููุดุชู ุท ูุดู ุชุง ุฎุฑูุฌ ุชููุฏ ุจุดู. ุจุนุฏ ุงุฒ ุงูฺฉู ุฎุฑูุฌ ุชููุฏ ุดุฏ ุงู ููุฏุงุฑ ุฏูุจุงุฑู ุจู ุณุฑูุฑ `WSGI` ูุฑู ุชุง ุงูู ุฑู ุจู ฺฉูุงูุช ุจุฑฺฏุฑุฏููู:

```python
# file: wsgiref/handlers.py
# class BaseHandler

    def finish_response(self):
        try:
            if not self.result_is_file() or not self.sendfile():
                for data in self.result:
                    self.write(data)
                self.finish_content()
        except:
            if hasattr(self.result, 'close'):
                self.result.close()
            raise
        else:
            self.close()

```

ุงฺฏู ูููุน ุฏุจุงฺฏ ุฑู ุฎุท `for data in self.result` ุชููู ฺฉูู ู ูุญุชูุง ุดุจู ุงู ูโุจูู ฺฉู ูุงูุนุง ุชู ุงูพูฺฉุดู ูุง ุชููุฏ ุดุฏู:

```shell
b'\n\n<!DOCTYPE html>\n<html dir="rtl">\n<head>\n    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>\n    <met...\n\n  \n    \n\n\n\n  \n ...
```

ฺฉุงุฑ ุงุตู ฺฉู ูุชุฏ ุจุงูุง ุงูุฌุงู ูุฏู ุงูู ฺฉู ุฏุงุฏูโูุง ุฎุฑูุฌ ุฑู ุฑู `wfile` ุจููุณู ู ุจุนุฏุด ุงู ุจุงูุฑ ุฑู ุฎุงู ฺฉูู ู ุจุนุฏุด ูู ุณูฺฉุช ุฑู ุจุจูุฏู. ุณุณุชูโุนุงูู ูู ูุชูุงุธุฑ ุจุง ุงูโูุง ุงูุฏุงูุงุช ุฎูุฏุด ุฑู ุงูุฌุงู ูุฏู:โ ุนู ุจุงูุฑ ุฑู `flush` ูฺฉูู ู ุฏุงุฏูโูุง ุงูู ุฑู ุงุฒ ุทุฑู ุณูฺฉุช ฺฉูุงูุช ุจุฑุงุด ููุฑุณุชู ู ุจุนุฏุด ุณูฺฉุช ุฑู โูุจูุฏู. ุงูุฌุง ุฏฺฏู ูุงูุนุง ฺฉูุงูุช ุฌูุงุจ ุฑู ุชู ูุฑูุฑฺฏุฑ ุฎูุฏุด ุฏุฑุงูุช ูโฺฉูู ู ุฑูุฏุฑ ุดุฏูโุงุด ุฑู ูโุจูู.
(๐ฎโ๐จ Such a long journey)

---

## ุฌูุนโุจูุฏ

ุฏุฑฺฉ ุฌุฒุฆุงุช ู ููู ุนูู ุงุจุฒุงุฑูุง ู ุทุฑูู ุงุณุชูุงุฏู ุงุฒ ุงููโูุง ุฏุบุฏุบู ููุดฺฏ ฺฉ **ูููุฏุณ ูุฑูโุงูุฒุงุฑ** ูุณุช. ุงฺฏู ุฐูู ูุง ูุงูโูุง ุนููฺฉุฑุฏ ุฏุงุฎูโ ุงุจุฒุงุฑูุง ุฑู ุฏุฑฺฉ ูฺฉูู ูุง ุฏุฑ ุงุฑุงุฆู ุฑุงูโุญูโูุง ูุงุจุณุชฺฏ ุฒุงุฏ ุจู ูุฑููุฑฺฉโูุง ูพุฏุง ูโฺฉูู ู ุจู ุงุตุทูุงุญ ููโุชููู `out of the box` ูฺฉุฑ ฺฉูู ฺูู ุงุฌุงุฒู ุฏุงุฏู ูุฑููุฑฺฉโูุง ุงู ุฌุฒุงุช ุฑู ุงุฒ ูุง ูุฎู ฺฉููุ ุจู ุฌุง ูุง ูฺฉุฑ ฺฉูู ู ุชุตูู ุจฺฏุฑูุฏ.

ุจู ูุธุฑู ุฏุฑ ูุฑุงูุฏ ุชูุณุนู ูุง ูุญุธูโุง ูโุชููู ุงุฏุนุง ฺฉูู ฺฉู ุฑุงูโุญูโูุง ุฎูุงูุงูู ุง ุงุตู ุงุฑุงุฆู ูโุฏู ฺฉู ุฐููุช ุฎูุฏููู ุฑู ุงุฒ ุชููุฏ ฺฉูุฑฺฉูุฑุงูู ุงุฒ ูุฑูโูุฑฺฉโูุง ุขุฒุงุฏ ฺฉุฑุฏู ุจุงุดู ุง ุจู ููู ูพฺู:

> ฺฉุณ ฺฉู ฺุฑุง ุฑุง ุจุฏุงูุฏุ ุจุง ูุฑ ฺฺฏููฺฏโุง ุฎูุงูุฏ ุณุงุฎุช ๐๐ป.
